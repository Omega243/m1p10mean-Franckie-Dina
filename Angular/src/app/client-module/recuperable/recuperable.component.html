<body>

  <div class="layout-wrapper layout-content-navbar">
    <div class="layout-container">

      <!-- Menu -->
      <app-client-menu></app-client-menu>
      <!-- Menus -->

      <div class="layout-page">

        <!-- HEADER -->
        <app-header></app-header>
        <!-- HEADER -->

        <!-- CONTENT -->
        <div class="content-wrapper">
          <div class="container-xxl flex-grow-1 container-p-y">
            <h4 class="fw-bold py-3 mb-4">Mes véhicules récupérables</h4>

            <button *ngIf="nextStepError != ''" class="btn btn-danger" style="width: 100%; text-align: center; margin-bottom:1%">
              <i class="bx bx-error"></i>
              {{ nextStepError }}
            </button>

            <button *ngIf="nextStepSuccess != ''" class="btn btn-success" style="width: 100%; text-align: center; margin-bottom:1%">
              <i class="bx bx-check-double"></i>
              {{ nextStepSuccess }}
            </button>

              <!-- Table -->
              <div class="card">
                <h5 class="card-header">Tableau récapitulatif</h5>
                <div class="table-responsive text-nowrap">
                  <table class="table">
                    <thead>
                      <tr>
                        <th>Matricule</th>
                        <th>Date de dépôt</th>
                        <th>Etat</th>
                        <th>Actions</th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody class="table-border-bottom-0">

                      <tr *ngFor="let fiche of fiches; let indexFiche=index;" >
                        <td>
                          <i class="fa fa-user me-1"></i> <strong>{{ fiche.voiture }}</strong>
                        </td>
                        <td>{{ fiche.datefiche | date: 'dd/MM/yyyy à HH:mm' }}</td>
                        <td>{{ fiche.etat.etatfiche.intitule }}</td>
                        <td>
                          <button *ngIf="nextSteps[indexFiche].exist && nextSteps[indexFiche].body.niveau != 5 " (click)="nextStep(fiche._id)" class="btn btn-primary" >
                            {{ nextSteps[indexFiche].body.intitule }}
                          </button>
                          <button *ngIf="!nextSteps[indexFiche].exist || nextSteps[indexFiche].body.niveau == 5 " class="btn btn-secondary" >
                            Aucune
                          </button>
                        </td>
                        <td>
                          <a [routerLink]="['/client/fiche-details/'+fiche._id]" >
                            <i class="bx bx-edit-alt me-1"></i> Détails
                          </a>
                        </td>
                      </tr>

                    </tbody>
                  </table>
                </div>
              </div>
              <!-- Table -->
            </div>
          </div>

        </div>
      </div>
  </div>

  <!-- FOOTER -->
  <app-footer></app-footer>
  <!-- FOOTER -->

</body>
